# Gitleaks configuration
# https://github.com/gitleaks/gitleaks

title = "Gitleaks Configuration for React Example"

[extend]
useDefault = true

[allowlist]
description = "Allowlist for known false positives"
regexes = [
  # Allow placeholder API keys in example files
  '''(VITE_API_KEY|API_KEY)=your_api_key_here''',
  '''(VITE_API_KEY|API_KEY)=.*example.*''',
]
paths = [
  # Ignore test files
  '''.*\.test\.tsx?$''',
  '''.*\.spec\.tsx?$''',
  # Ignore example env files
  '''\.env\.example$''',
  # Ignore documentation
  '''.*\.md$''',
]

[[rules]]
id = "generic-api-key"
description = "Detected a Generic API Key"
regex = '''(?i)(api[_-]?key|apikey|api[_-]?secret)\s*[:=]\s*['"]?([a-z0-9_\-]{32,})['"]?'''
keywords = [
  "apikey",
  "api_key",
  "api-key",
]

[[rules]]
id = "env-variable-secret"
description = "Potential secret in environment variable"
regex = '''(?i)(password|secret|token|key)\s*[:=]\s*['"]?([a-z0-9_\-]{20,})['"]?'''
keywords = [
  "password",
  "secret",
  "token",
]

